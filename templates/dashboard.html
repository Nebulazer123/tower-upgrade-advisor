{% extends "base.html" %}

{% block title %}{{ profile.name }} â€” Tower Upgrade Advisor{% endblock %}

{% block nav_right %}
<div class="nav-actions">
  <a href="{{ url_for('recommend', profile_id=profile.id) }}" class="btn btn-primary btn-sm">Get Recommendation</a>
</div>
{% endblock %}

{% block content %}
<header class="page-header">
  <h1>{{ profile.name }}</h1>
  <div class="coins-editor">
    <label for="coins-input">Available Coins:</label>
    <input type="number" id="coins-input" name="coins" min="0"
           value="{{ profile.available_coins }}"
           hx-post="{{ url_for('update_coins', profile_id=profile.id) }}"
           hx-trigger="change, keyup[key=='Enter']"
           hx-target="#coins-display"
           hx-swap="innerHTML">
    <span id="coins-display" class="coins-value">{{ profile.available_coins | commas }}</span>
  </div>
</header>

{% for cat in categories %}
<section class="card category-card">
  <h2 class="category-title category-{{ cat }}">{{ cat | capitalize }}</h2>
  <div class="upgrade-table-wrap">
    <table class="upgrade-table">
      <thead>
        <tr>
          <th class="col-name">Upgrade</th>
          <th class="col-level">Level</th>
          <th class="col-max">Max</th>
          <th class="col-current-effect">Current Effect</th>
          <th class="col-cost">Next Cost</th>
          <th class="col-delta">Next Effect</th>
        </tr>
      </thead>
      <tbody>
        {% for row in upgrades_by_cat[cat] %}
        {% include "partials/upgrade_row.html" %}
        {% endfor %}
      </tbody>
    </table>
  </div>
</section>
{% endfor %}

<div class="page-actions">
  <a href="{{ url_for('recommend', profile_id=profile.id) }}" class="btn btn-primary btn-lg">Get Recommendation</a>
  <a href="{{ url_for('index') }}" class="btn btn-sm">Back to Profiles</a>
</div>
{% endblock %}
